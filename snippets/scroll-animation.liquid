{% comment %}
  Scroll Animation Snippet
  Add scroll-triggered animations to sections
  
  Usage: {% render 'scroll-animation' %}
  
  Then add 'scroll-fade-in' class to elements you want to animate
{% endcomment %}

<style>
  .scroll-fade-in {
    opacity: 0;
    transform: translateY(40px) scale(0.95) rotateX(10deg);
    filter: blur(4px);
    transition: opacity 0.7s cubic-bezier(0.34, 1.56, 0.64, 1),
                transform 0.7s cubic-bezier(0.34, 1.56, 0.64, 1),
                filter 0.7s cubic-bezier(0.34, 1.56, 0.64, 1);
    transform-origin: center bottom;
  }

  .scroll-fade-in.visible {
    opacity: 1;
    transform: translateY(0) scale(1) rotateX(0);
    filter: blur(0);
  }

  /* Stagger delays with faster timing */
  .scroll-fade-in[data-scroll-delay="1"].visible { transition-delay: 80ms; }
  .scroll-fade-in[data-scroll-delay="2"].visible { transition-delay: 160ms; }
  .scroll-fade-in[data-scroll-delay="3"].visible { transition-delay: 240ms; }
  .scroll-fade-in[data-scroll-delay="4"].visible { transition-delay: 320ms; }
  .scroll-fade-in[data-scroll-delay="5"].visible { transition-delay: 400ms; }
  .scroll-fade-in[data-scroll-delay="6"].visible { transition-delay: 480ms; }

  /* Faster stagger on mobile */
  @media (max-width: 749px) {
    .scroll-fade-in[data-scroll-delay="1"].visible { transition-delay: 40ms; }
    .scroll-fade-in[data-scroll-delay="2"].visible { transition-delay: 80ms; }
    .scroll-fade-in[data-scroll-delay="3"].visible { transition-delay: 120ms; }
    .scroll-fade-in[data-scroll-delay="4"].visible { transition-delay: 160ms; }
    .scroll-fade-in[data-scroll-delay="5"].visible { transition-delay: 200ms; }
    .scroll-fade-in[data-scroll-delay="6"].visible { transition-delay: 240ms; }
  }
</style>

<script>
  (function() {
    if (window.scrollAnimationInitialized) return;
    window.scrollAnimationInitialized = true;

    const observerOptions = {
      root: null,
      rootMargin: '0px 0px -100px 0px',
      threshold: 0.1
    };

    const observer = new IntersectionObserver((entries) => {
      entries.forEach(entry => {
        if (entry.isIntersecting) {
          entry.target.classList.add('visible');
          observer.unobserve(entry.target);
        }
      });
    }, observerOptions);

    function observeElements() {
      const elements = document.querySelectorAll('.scroll-fade-in:not(.visible)');
      elements.forEach(el => observer.observe(el));
    }

    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', observeElements);
    } else {
      observeElements();
    }

    // Re-observe when Shopify sections are loaded/reloaded
    document.addEventListener('shopify:section:load', observeElements);
  })();
</script>
