{% stylesheet %}
  .ctb-about {
    background: {{ section.settings.background_color }};
    padding: {{ section.settings.padding_top }}px 0 {{ section.settings.padding_bottom }}px 0;
    color: {{ section.settings.text_color }};
  }

  .ctb-about__inner {
    max-width: 1200px;
    margin: 0 auto;
    padding: 0 20px;
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 2.5rem;
    align-items: center;
  }

  .ctb-about__title {
    font-size: clamp(2rem, 4vw, 3rem);
    margin: 0 0 1rem 0;
    color: {{ section.settings.heading_color }};
    text-transform: uppercase;
    letter-spacing: 1px;
  }

  .ctb-about__desc {
    margin: 0 0 1.5rem 0;
    line-height: 1.7;
    color: {{ section.settings.subtext_color }};
  }

  .ctb-about__list {
    list-style: none;
    padding: 0;
    margin: 0 0 1.5rem 0;
    display: flex;
    flex-direction: column;
    gap: 1rem;
  }

  .ctb-about__item {
    display: grid;
    grid-template-columns: auto 1fr;
    gap: 0.75rem 1rem;
    align-items: start;
  }

  .ctb-about__item i {
    color: {{ section.settings.accent_color }};
    margin-top: 3px;
  }

  .ctb-about__item-title {
    margin: 0;
    font-weight: 700;
    color: {{ section.settings.heading_color }};
  }

  .ctb-about__item-text {
    margin: 0;
    color: {{ section.settings.subtext_color }};
  }

  .ctb-about__social {
    margin: 1.25rem 0;
    color: {{ section.settings.subtext_color }};
  }

  .ctb-about__social a {
    color: {{ section.settings.accent_color }};
    text-decoration: none;
    font-weight: 700;
  }

  .ctb-about__social a:hover {
    text-decoration: underline;
  }

  .ctb-about__cta {
    display: inline-flex;
    align-items: center;
    gap: 0.5rem;
    padding: 12px 26px;
    background: {{ section.settings.accent_color }};
    color: #050505;
    border-radius: 6px;
    text-decoration: none;
    font-weight: 700;
    border: 2px solid {{ section.settings.accent_color }};
    transition: all 0.2s ease;
  }

  .ctb-about__cta:hover {
    box-shadow: 0 10px 30px rgba(245, 215, 110, 0.25);
    transform: translateY(-2px);
  }

  .ctb-about__media {
    position: relative;
    border-radius: 10px;
    overflow: hidden;
    box-shadow: 0 20px 50px rgba(0, 0, 0, 0.35);
  }

  .ctb-about__media img {
    width: 100%;
    display: block;
  }

  .ctb-about .splide__pagination__page.is-active {
    background: {{ section.settings.accent_color }};
  }

  .ctb-about .splide__arrow {
    background: rgba(255, 255, 255, 0.08);
    border: 1px solid rgba(255, 255, 255, 0.15);
    color: #f5f5f5;
  }

  .ctb-about .splide__arrow:hover {
    border-color: {{ section.settings.accent_color }};
    color: {{ section.settings.accent_color }};
  }

  @media (max-width: 1024px) {
    .ctb-about__inner {
      grid-template-columns: 1fr;
    }
  }

  @media (max-width: 768px) {
    .ctb-about {
      padding: {{ section.settings.padding_top | times: 0.75 | round: 0 }}px 0 {{ section.settings.padding_bottom | times: 0.75 | round: 0 }}px 0;
    }

    .ctb-about__inner {
      padding: 0 16px;
    }
  }
{% endstylesheet %}

{% javascript %}
  document.addEventListener('DOMContentLoaded', function() {
    const slider = document.querySelector('#ctb-about-{{ section.id }} .ctb-about__slider');
    if (!slider || typeof Splide === 'undefined') return;

    const splide = new Splide(slider, {
      type: 'fade',
      rewind: true,
      arrows: true,
      pagination: true,
      autoplay: {{ section.settings.autoplay | json }},
      interval: {{ section.settings.autoplay_speed }},
      speed: 800,
      pauseOnHover: true,
    });

    splide.mount();
  });
{% endjavascript %}

<section id="ctb-about-{{ section.id }}" class="ctb-about">
  <div class="ctb-about__inner">
    <div class="ctb-about__copy">
      <h2 class="ctb-about__title">{{ section.settings.heading }}</h2>
      <p class="ctb-about__desc">{{ section.settings.description }}</p>

      {% if section.blocks.size > 0 %}
        <ul class="ctb-about__list">
          {% for block in section.blocks %}
            {% if block.type == 'feature' %}
              <li class="ctb-about__item">
                <i class="{{ block.settings.icon_class }}" aria-hidden="true"></i>
                <div>
                  <p class="ctb-about__item-title">{{ block.settings.title }}</p>
                  <p class="ctb-about__item-text">{{ block.settings.detail }}</p>
                </div>
              </li>
            {% endif %}
          {% endfor %}
        </ul>
      {% endif %}

      {% if section.settings.instagram_handle != blank %}
        <p class="ctb-about__social">
          {{ section.settings.social_text }}
          <a href="https://www.instagram.com/{{ section.settings.instagram_handle | replace: '@', '' }}/" target="_blank">@{{ section.settings.instagram_handle | replace: '@', '' }}</a>
        </p>
      {% endif %}

      {% if section.settings.button_text != blank %}
        <a class="ctb-about__cta" href="{{ section.settings.button_link }}">{{ section.settings.button_text }}</a>
      {% endif %}
    </div>

    <div class="ctb-about__media">
      {% assign image_blocks = section.blocks | where: 'type', 'image' %}
      {% if section.settings.single_image != blank %}
        <img src="{{ section.settings.single_image | image_url: width: 1000 }}" alt="{{ section.settings.single_image.alt }}">
      {% elsif image_blocks.size > 0 %}
        <div class="ctb-about__slider splide" aria-label="About gallery">
          <div class="splide__track">
            <ul class="splide__list">
              {% for block in image_blocks %}
                {% if block.settings.image != blank %}
                  <li class="splide__slide">
                    <img src="{{ block.settings.image | image_url: width: 1000 }}" alt="{{ block.settings.image.alt | default: 'About image' }}" loading="lazy">
                  </li>
                {% endif %}
              {% endfor %}
            </ul>
          </div>
        </div>
      {% endif %}
    </div>
  </div>
</section>

{% schema %}
{
  "name": "CTB About (Black)",
  "settings": [
    {"type": "text", "id": "heading", "label": "Heading", "default": "About CTB Garage"},
    {"type": "textarea", "id": "description", "label": "Description", "default": "Welcome to CTB Garage — Chicago's premier destination for auto body repair, restorations, and automotive lifestyle."},
    {"type": "text", "id": "social_text", "label": "Social Text", "default": "Follow us:"},
    {"type": "text", "id": "instagram_handle", "label": "Instagram Handle", "default": "@ctbgarage"},
    {"type": "text", "id": "button_text", "label": "CTA Text", "default": "Contact Us for a Build"},
    {"type": "url", "id": "button_link", "label": "CTA Link", "default": "#contact"},
    {"type": "image_picker", "id": "single_image", "label": "Single Image (overrides slider)"},
    {"type": "checkbox", "id": "autoplay", "label": "Autoplay slider", "default": true},
    {"type": "range", "id": "autoplay_speed", "min": 3000, "max": 10000, "step": 500, "unit": "ms", "label": "Autoplay speed", "default": 4500},
    {"type": "range", "id": "padding_top", "min": 20, "max": 140, "step": 10, "unit": "px", "label": "Padding Top", "default": 80},
    {"type": "range", "id": "padding_bottom", "min": 20, "max": 140, "step": 10, "unit": "px", "label": "Padding Bottom", "default": 80},
    {"type": "color", "id": "background_color", "label": "Background", "default": "#080808"},
    {"type": "color", "id": "heading_color", "label": "Heading Color", "default": "#f5f5f5"},
    {"type": "color", "id": "text_color", "label": "Text Color", "default": "#e5e5e5"},
    {"type": "color", "id": "subtext_color", "label": "Secondary Text Color", "default": "#bfbfbf"},
    {"type": "color", "id": "accent_color", "label": "Accent Color", "default": "#f5d76e"}
  ],
  "blocks": [
    {
      "type": "feature",
      "name": "Feature",
      "settings": [
        {"type": "text", "id": "icon_class", "label": "Icon class", "default": "fas fa-check"},
        {"type": "text", "id": "title", "label": "Title", "default": "Professional Auto Body Repair"},
        {"type": "textarea", "id": "detail", "label": "Detail", "default": "Expert collision repair, paint work, and restoration services."}
      ]
    },
    {
      "type": "image",
      "name": "Slider Image",
      "settings": [
        {"type": "image_picker", "id": "image", "label": "Image"}
      ]
    }
  ],
  "presets": [
    {
      "name": "CTB About (Black)",
      "category": "Custom",
      "blocks": [
        {"type": "feature"},
        {"type": "feature", "settings": {"title": "Located in Chicago", "detail": "4201 W Kinzie Street — visit the shop or book online."}},
        {"type": "feature", "settings": {"title": "Event Tickets", "detail": "Exclusive Chicago car events and meets."}},
        {"type": "image"},
        {"type": "image"}
      ]
    }
  ]
}
{% endschema %}
