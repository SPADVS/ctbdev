{% stylesheet %}
  @import url('https://fonts.googleapis.com/css2?family=Oswald:wght@400;700&family=Roboto:wght@300;400;700&display=swap');
  @import url('https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css');

  #ctb-garage-{{ section.id }} {
    --ctb-bg: {{ section.settings.background_color }};
    --ctb-card: {{ section.settings.card_color }};
    --ctb-text: {{ section.settings.text_color }};
    --ctb-muted: {{ section.settings.muted_color }};
    --ctb-accent: {{ section.settings.accent_color }};
    --ctb-shadow: 0 14px 40px rgba(0, 0, 0, 0.35);
    font-family: 'Roboto', system-ui, -apple-system, sans-serif;
    background: var(--ctb-bg);
    color: var(--ctb-text);
    position: relative;
    overflow: hidden;
  }

  #ctb-garage-{{ section.id }} .ctb-container {
    max-width: 1200px;
    margin: 0 auto;
    padding: 0 20px;
    width: 100%;
  }

  #ctb-garage-{{ section.id }} .ctb-section {
    padding: clamp(60px, 8vw, 100px) 0;
  }

  #ctb-garage-{{ section.id }} .ctb-title {
    font-family: 'Oswald', 'Roboto', sans-serif;
    text-transform: uppercase;
    letter-spacing: 1px;
    font-size: clamp(2rem, 5vw, 3rem);
    margin-bottom: 12px;
  }

  #ctb-garage-{{ section.id }} .ctb-subtitle {
    color: var(--ctb-muted);
    max-width: 760px;
    margin-bottom: 28px;
  }

  #ctb-garage-{{ section.id }} .ctb-btn {
    display: inline-flex;
    align-items: center;
    gap: 10px;
    padding: 12px 26px;
    border-radius: 6px;
    border: 2px solid var(--ctb-accent);
    color: #050505;
    background: var(--ctb-accent);
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    transition: all 0.2s ease;
  }

  #ctb-garage-{{ section.id }} .ctb-btn--ghost {
    background: transparent;
    color: var(--ctb-text);
  }

  #ctb-garage-{{ section.id }} .ctb-btn:hover {
    transform: translateY(-1px);
    box-shadow: var(--ctb-shadow);
  }

  /* Info bar */
  #ctb-garage-{{ section.id }} .ctb-info {
    background: rgba(255, 255, 255, 0.04);
    border-bottom: 1px solid rgba(255, 255, 255, 0.06);
    padding: 10px 0;
  }

  #ctb-garage-{{ section.id }} .ctb-info__item {
    display: flex;
    align-items: center;
    gap: 10px;
    font-size: 0.95rem;
    color: var(--ctb-muted);
  }

  #ctb-garage-{{ section.id }} .ctb-info__item i {
    color: var(--ctb-accent);
  }

  /* Hero */
  #ctb-garage-{{ section.id }} .ctb-hero {
    position: relative;
    min-height: 80vh;
    display: grid;
    align-items: stretch;
    background: radial-gradient(circle at 20% 20%, rgba(255,255,255,0.06), transparent 28%), #050505;
  }

  #ctb-garage-{{ section.id }} .ctb-hero__media {
    position: absolute;
    inset: 0;
    overflow: hidden;
  }

  #ctb-garage-{{ section.id }} .ctb-hero__overlay {
    position: absolute;
    inset: 0;
    background: linear-gradient(180deg, rgba(0,0,0,0.65), rgba(0,0,0,0.88));
    opacity: {{ section.settings.overlay_opacity | divided_by: 100.0 }};
    pointer-events: none;
  }

  #ctb-garage-{{ section.id }} .ctb-hero__content {
    position: relative;
    z-index: 2;
    padding: clamp(80px, 10vw, 120px) 20px;
    max-width: 1200px;
    margin: 0 auto;
    display: grid;
    gap: 18px;
  }

  #ctb-garage-{{ section.id }} .ctb-hero__eyebrow {
    display: inline-flex;
    align-items: center;
    gap: 8px;
    background: rgba(255,255,255,0.08);
    border: 1px solid rgba(255,255,255,0.16);
    border-radius: 999px;
    padding: 8px 16px;
    color: var(--ctb-accent);
    text-transform: uppercase;
    font-weight: 700;
    letter-spacing: 0.5px;
    width: fit-content;
  }

  #ctb-garage-{{ section.id }} .ctb-hero__title {
    font-family: 'Oswald', 'Roboto', sans-serif;
    font-size: clamp(2.6rem, 6vw, 4.6rem);
    letter-spacing: 1px;
    margin: 0;
  }

  #ctb-garage-{{ section.id }} .ctb-hero__tagline {
    font-size: clamp(1.05rem, 2.6vw, 1.35rem);
    color: var(--ctb-muted);
    max-width: 720px;
  }

  #ctb-garage-{{ section.id }} .ctb-hero__actions {
    display: flex;
    flex-wrap: wrap;
    gap: 12px;
  }

  #ctb-garage-{{ section.id }} .ctb-hero__metrics {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
    gap: 14px;
  }

  #ctb-garage-{{ section.id }} .ctb-metric {
    background: rgba(255, 255, 255, 0.05);
    border: 1px solid rgba(255, 255, 255, 0.12);
    border-radius: 12px;
    padding: 12px 14px;
  }

  #ctb-garage-{{ section.id }} .ctb-metric strong {
    color: var(--ctb-accent);
    display: block;
    font-size: 1.2rem;
  }

  #ctb-garage-{{ section.id }} .ctb-metric span {
    color: var(--ctb-muted);
    font-size: 0.95rem;
  }

  #ctb-garage-{{ section.id }} .ctb-hero__slide video,
  #ctb-garage-{{ section.id }} .ctb-hero__slide img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    position: absolute;
    inset: 0;
  }

  #ctb-garage-{{ section.id }} .ctb-hero__slide {
    position: relative;
    height: 100%;
    min-height: 70vh;
    background: #000;
  }

  /* Features */
  #ctb-garage-{{ section.id }} .ctb-feature-list {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
    gap: 14px;
    margin-top: 24px;
  }

  #ctb-garage-{{ section.id }} .ctb-feature {
    background: rgba(255,255,255,0.05);
    border: 1px solid rgba(255,255,255,0.08);
    border-radius: 10px;
    padding: 14px 16px;
    display: flex;
    align-items: flex-start;
    gap: 12px;
    color: var(--ctb-muted);
  }

  #ctb-garage-{{ section.id }} .ctb-feature i {
    color: var(--ctb-accent);
    margin-top: 4px;
  }

  /* About */
  #ctb-garage-{{ section.id }} .ctb-about {
    display: grid;
    gap: 26px;
    grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
    align-items: center;
  }

  #ctb-garage-{{ section.id }} .ctb-about__text {
    background: rgba(255,255,255,0.03);
    border: 1px solid rgba(255,255,255,0.08);
    padding: 22px;
    border-radius: 14px;
    box-shadow: var(--ctb-shadow);
  }

  #ctb-garage-{{ section.id }} .ctb-about__bullets {
    display: grid;
    gap: 10px;
    margin: 18px 0;
    color: var(--ctb-muted);
  }

  #ctb-garage-{{ section.id }} .ctb-about__bullets li {
    display: flex;
    gap: 10px;
  }

  #ctb-garage-{{ section.id }} .ctb-about__slider img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    border-radius: 14px;
    border: 1px solid rgba(255,255,255,0.08);
    box-shadow: var(--ctb-shadow);
  }

  /* Merch carousel */
  #ctb-garage-{{ section.id }} .ctb-merch__item {
    background: var(--ctb-card);
    border: 1px solid rgba(255,255,255,0.08);
    border-radius: 14px;
    overflow: hidden;
    box-shadow: var(--ctb-shadow);
  }

  #ctb-garage-{{ section.id }} .ctb-merch__item img {
    width: 100%;
    aspect-ratio: 4 / 5;
    object-fit: cover;
  }

  #ctb-garage-{{ section.id }} .ctb-merch__body {
    padding: 14px 16px 18px;
    display: grid;
    gap: 6px;
  }

  #ctb-garage-{{ section.id }} .ctb-price {
    color: var(--ctb-accent);
    font-weight: 700;
  }

  /* Tickets */
  #ctb-garage-{{ section.id }} .ctb-ticket-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
    gap: 18px;
  }

  #ctb-garage-{{ section.id }} .ctb-ticket {
    background: rgba(255,255,255,0.04);
    border: 1px solid rgba(255,255,255,0.08);
    border-radius: 14px;
    overflow: hidden;
    display: grid;
    grid-template-rows: auto 1fr;
    box-shadow: var(--ctb-shadow);
  }

  #ctb-garage-{{ section.id }} .ctb-ticket img {
    width: 100%;
    height: 180px;
    object-fit: cover;
  }

  #ctb-garage-{{ section.id }} .ctb-ticket__body {
    padding: 16px 18px 20px;
    display: grid;
    gap: 10px;
  }

  /* Testimonials */
  #ctb-garage-{{ section.id }} .ctb-testimonial {
    background: rgba(255,255,255,0.04);
    border: 1px solid rgba(255,255,255,0.08);
    border-radius: 14px;
    padding: 18px;
    min-height: 220px;
    display: grid;
    gap: 10px;
    box-shadow: var(--ctb-shadow);
  }

  #ctb-garage-{{ section.id }} .ctb-stars {
    color: var(--ctb-accent);
    letter-spacing: 1px;
  }

  /* Gallery */
  #ctb-garage-{{ section.id }} .ctb-gallery__item img {
    width: 100%;
    height: 320px;
    object-fit: cover;
    border-radius: 14px;
    border: 1px solid rgba(255,255,255,0.08);
    box-shadow: var(--ctb-shadow);
  }

  /* FAQ */
  #ctb-garage-{{ section.id }} .ctb-faq {
    display: grid;
    gap: 12px;
    max-width: 960px;
    margin: 0 auto;
  }

  #ctb-garage-{{ section.id }} .ctb-faq__item {
    border: 1px solid rgba(255,255,255,0.12);
    border-radius: 10px;
    background: rgba(255,255,255,0.03);
    overflow: hidden;
  }

  #ctb-garage-{{ section.id }} .ctb-faq__question {
    width: 100%;
    background: transparent;
    color: var(--ctb-text);
    padding: 14px 16px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    font-weight: 700;
    border: none;
    cursor: pointer;
  }

  #ctb-garage-{{ section.id }} .ctb-faq__answer {
    max-height: 0;
    overflow: hidden;
    transition: max-height 0.3s ease;
    padding: 0 16px;
    color: var(--ctb-muted);
  }

  #ctb-garage-{{ section.id }} .ctb-faq__item.is-open .ctb-faq__answer {
    max-height: 500px;
    padding-bottom: 14px;
  }

  /* Contact */
  #ctb-garage-{{ section.id }} .ctb-contact {
    display: grid;
    gap: 22px;
    grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
  }

  #ctb-garage-{{ section.id }} .ctb-contact__card {
    background: rgba(255,255,255,0.04);
    border: 1px solid rgba(255,255,255,0.08);
    border-radius: 14px;
    padding: 20px;
    display: grid;
    gap: 12px;
    box-shadow: var(--ctb-shadow);
  }

  #ctb-garage-{{ section.id }} .ctb-contact__form input,
  #ctb-garage-{{ section.id }} .ctb-contact__form textarea {
    width: 100%;
    padding: 12px 14px;
    border-radius: 8px;
    border: 1px solid rgba(255,255,255,0.16);
    background: rgba(255,255,255,0.04);
    color: var(--ctb-text);
  }

  #ctb-garage-{{ section.id }} .ctb-contact__form textarea { min-height: 140px; resize: vertical; }

  #ctb-garage-{{ section.id }} .ctb-note {
    font-size: 0.9rem;
    color: var(--ctb-muted);
  }

  /* Floating button & modal */
  #ctb-garage-{{ section.id }} .ctb-float-btn {
    position: fixed;
    right: 18px;
    bottom: 24px;
    z-index: 20;
    display: inline-flex;
    align-items: center;
    gap: 10px;
    background: var(--ctb-accent);
    color: #050505;
    border-radius: 999px;
    padding: 12px 18px;
    border: none;
    font-weight: 800;
    box-shadow: var(--ctb-shadow);
    cursor: pointer;
  }

  #ctb-garage-{{ section.id }} .ctb-modal {
    position: fixed;
    inset: 0;
    display: none;
    align-items: center;
    justify-content: center;
    z-index: 30;
  }

  #ctb-garage-{{ section.id }} .ctb-modal.is-open { display: flex; }

  #ctb-garage-{{ section.id }} .ctb-modal__overlay {
    position: absolute;
    inset: 0;
    background: rgba(0,0,0,0.65);
    backdrop-filter: blur(6px);
  }

  #ctb-garage-{{ section.id }} .ctb-modal__content {
    position: relative;
    background: #0a0a0a;
    color: var(--ctb-text);
    border: 1px solid rgba(255,255,255,0.1);
    border-radius: 16px;
    padding: 22px;
    width: min(980px, 94vw);
    max-height: 90vh;
    overflow: auto;
    box-shadow: var(--ctb-shadow);
    z-index: 1;
  }

  #ctb-garage-{{ section.id }} .ctb-modal__close {
    position: absolute;
    top: 10px;
    right: 10px;
    background: transparent;
    color: var(--ctb-text);
    border: none;
    font-size: 1.2rem;
    cursor: pointer;
  }

  #ctb-garage-{{ section.id }} .ctb-modal__grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
    gap: 14px;
  }

  /* Responsive */
  @media (max-width: 768px) {
    #ctb-garage-{{ section.id }} .ctb-hero__content {
      padding: 70px 16px;
    }

    #ctb-garage-{{ section.id }} .ctb-hero__actions {
      flex-direction: column;
      align-items: flex-start;
    }

    #ctb-garage-{{ section.id }} .ctb-float-btn {
      left: 50%;
      right: auto;
      transform: translateX(-50%);
    }
  }
{% endstylesheet %}

{% javascript %}
  document.addEventListener('DOMContentLoaded', function() {
    const root = document.getElementById('ctb-garage-{{ section.id }}');
    if (!root) return;

    const loadAsset = (id, url, kind, callback) => {
      if (document.getElementById(id)) {
        if (callback) callback();
        return;
      }
      if (kind === 'style') {
        const link = document.createElement('link');
        link.id = id;
        link.rel = 'stylesheet';
        link.href = url;
        document.head.appendChild(link);
        if (callback) link.onload = callback;
      } else {
        const script = document.createElement('script');
        script.id = id;
        script.src = url;
        script.async = true;
        script.onload = callback;
        document.body.appendChild(script);
      }
    };

    loadAsset('ctb-splide-css', 'https://cdn.jsdelivr.net/npm/@splidejs/splide@4.1.4/dist/css/splide.min.css', 'style');
    loadAsset('ctb-splide-js', 'https://cdn.jsdelivr.net/npm/@splidejs/splide@4.1.4/dist/js/splide.min.js', 'script', initSplides);
    loadAsset('ctb-splide-auto', 'https://cdn.jsdelivr.net/npm/@splidejs/splide-extension-auto-scroll@0.5.3/dist/js/splide-extension-auto-scroll.min.js', 'script');

    function initSplides() {
      if (typeof Splide === 'undefined') return;

      const infoEl = root.querySelector('.ctb-info-splide');
      if (infoEl) {
        new Splide(infoEl, { type: 'loop', arrows: false, pagination: false, perPage: 1, autoplay: true, interval: 2200 }).mount();
      }

      const heroEl = root.querySelector('.ctb-hero-splide');
      if (heroEl) {
        const hero = new Splide(heroEl, { type: 'fade', rewind: true, arrows: false, pagination: true, autoplay: true, interval: 6000, speed: 1200 });

        const playActiveVideo = () => {
          heroEl.querySelectorAll('video').forEach(v => { v.pause(); v.currentTime = 0; });
          const active = heroEl.querySelector('.splide__slide.is-active video');
          if (active) {
            active.play().catch(() => {});
          }
        };

        hero.on('mounted move', playActiveVideo);
        hero.mount();
      }

      const aboutEl = root.querySelector('.ctb-about-splide');
      if (aboutEl) {
        new Splide(aboutEl, { type: 'fade', rewind: true, autoplay: true, interval: 4200, arrows: false, pagination: true }).mount();
      }

      const merchEl = root.querySelector('.ctb-merch-splide');
      if (merchEl) {
        const merch = new Splide(merchEl, { type: 'loop', autoWidth: true, gap: '18px', pagination: false, arrows: false, drag: 'free', autoScroll: { speed: 0.8 } });
        try {
          if (window.splide && window.splide.Extensions) {
            merch.mount(window.splide.Extensions);
          } else {
            merch.mount();
          }
        } catch (e) {
          merch.mount();
        }
      }

      const galleryEl = root.querySelector('.ctb-gallery-splide');
      if (galleryEl) {
        new Splide(galleryEl, { type: 'loop', perPage: 3, gap: '20px', autoplay: true, interval: 3200, breakpoints: { 1024: { perPage: 2 }, 768: { perPage: 1 } } }).mount();
      }

      const testimonialsEl = root.querySelector('.ctb-testimonial-splide');
      if (testimonialsEl) {
        new Splide(testimonialsEl, { type: 'loop', perPage: 3, gap: '18px', autoplay: true, interval: 3200, breakpoints: { 1024: { perPage: 2 }, 768: { perPage: 1 } } }).mount();
      }
    }

    root.querySelectorAll('[data-ctb-faq]').forEach(btn => {
      btn.addEventListener('click', () => {
        const item = btn.closest('.ctb-faq__item');
        if (!item) return;
        item.classList.toggle('is-open');
      });
    });

    const modal = root.querySelector('[data-ctb-modal]');
    const openBtn = root.querySelector('[data-ctb-open-modal]');
    const closeBtn = root.querySelector('[data-ctb-close-modal]');
    if (modal && openBtn) {
      const closeModal = () => modal.classList.remove('is-open');
      openBtn.addEventListener('click', () => modal.classList.add('is-open'));
      modal.addEventListener('click', (e) => { if (e.target === modal || e.target.dataset.ctbCloseModal === 'true') closeModal(); });
      if (closeBtn) closeBtn.addEventListener('click', closeModal);
      document.addEventListener('keydown', (e) => { if (e.key === 'Escape') closeModal(); });
    }
  });
{% endjavascript %}

<section id="ctb-garage-{{ section.id }}" class="ctb-garage">
  {% if section.settings.show_info_bar and section.blocks | where: 'type', 'info_item' %}
    <div class="ctb-info">
      <div class="ctb-container">
        <div class="ctb-info-splide splide" aria-label="CTB info bar">
          <div class="splide__track">
            <ul class="splide__list">
              {% for block in section.blocks %}
                {% if block.type == 'info_item' %}
                  <li class="splide__slide">
                    <div class="ctb-info__item">
                      {% if block.settings.icon != blank %}<i class="{{ block.settings.icon }}" aria-hidden="true"></i>{% endif %}
                      {% if block.settings.link != blank %}
                        <a href="{{ block.settings.link }}" target="{% if block.settings.open_in_new_tab %}_blank{% else %}_self{% endif %}" rel="noopener noreferrer">{{ block.settings.text }}</a>
                      {% else %}
                        <span>{{ block.settings.text }}</span>
                      {% endif %}
                    </div>
                  </li>
                {% endif %}
              {% endfor %}
            </ul>
          </div>
        </div>
      </div>
    </div>
  {% endif %}

  <div class="ctb-hero" id="home">
    <div class="ctb-hero__media">
      {% if section.blocks.size > 0 %}
        <div class="ctb-hero-splide splide" aria-label="Hero visuals">
          <div class="splide__track">
            <ul class="splide__list">
              {% for block in section.blocks %}
                {% if block.type == 'hero_slide' %}
                  <li class="splide__slide">
                    <div class="ctb-hero__slide">
                      {% if block.settings.poster != blank %}
                        <img src="{{ block.settings.poster | image_url: width: 1920 }}" alt="{{ block.settings.poster.alt | default: 'Hero poster' }}" loading="lazy">
                      {% endif %}
                      {% if block.settings.video_mp4 != blank %}
                        <video muted loop playsinline preload="auto" poster="{{ block.settings.poster | image_url: width: 1920 }}">
                          <source src="{{ block.settings.video_mp4 }}" type="video/mp4">
                        </video>
                      {% elsif block.settings.fallback_image != blank %}
                        <img src="{{ block.settings.fallback_image | image_url: width: 1920 }}" alt="{{ block.settings.fallback_image.alt | default: 'Hero image' }}" loading="lazy">
                      {% endif %}
                    </div>
                  </li>
                {% endif %}
              {% endfor %}
            </ul>
          </div>
        </div>
      {% elsif section.settings.hero_image %}
        <div class="ctb-hero__slide">
          <img src="{{ section.settings.hero_image | image_url: width: 1920 }}" alt="{{ section.settings.hero_image.alt | default: 'Hero image' }}" loading="lazy">
        </div>
      {% endif %}
    </div>

    <div class="ctb-hero__overlay"></div>

    <div class="ctb-hero__content">
      {% if section.settings.eyebrow != blank %}
        <span class="ctb-hero__eyebrow">{{ section.settings.eyebrow }}</span>
      {% endif %}
      <h1 class="ctb-hero__title">{{ section.settings.heading }}</h1>
      <p class="ctb-hero__tagline">{{ section.settings.tagline }}</p>
      <div class="ctb-hero__actions">
        {% if section.settings.primary_text != blank %}
          <a class="ctb-btn" href="{{ section.settings.primary_link }}">
            {% if section.settings.primary_icon != blank %}<i class="{{ section.settings.primary_icon }}" aria-hidden="true"></i>{% endif %}
            {{ section.settings.primary_text }}
          </a>
        {% endif %}
        {% if section.settings.secondary_text != blank %}
          <a class="ctb-btn ctb-btn--ghost" href="{{ section.settings.secondary_link }}">
            {% if section.settings.secondary_icon != blank %}<i class="{{ section.settings.secondary_icon }}" aria-hidden="true"></i>{% endif %}
            {{ section.settings.secondary_text }}
          </a>
        {% endif %}
      </div>
      {% if section.blocks | where: 'type', 'hero_metric' %}
        <div class="ctb-hero__metrics">
          {% for block in section.blocks %}
            {% if block.type == 'hero_metric' %}
              <div class="ctb-metric">
                <strong>{{ block.settings.value }}</strong>
                <span>{{ block.settings.label }}</span>
              </div>
            {% endif %}
          {% endfor %}
        </div>
      {% endif %}
    </div>
  </div>

  <div class="ctb-section" id="features">
    <div class="ctb-container">
      <h2 class="ctb-title">{{ section.settings.features_heading }}</h2>
      {% if section.settings.features_subtitle != blank %}<p class="ctb-subtitle">{{ section.settings.features_subtitle }}</p>{% endif %}
      {% if section.blocks | where: 'type', 'feature' %}
        <div class="ctb-feature-list">
          {% for block in section.blocks %}
            {% if block.type == 'feature' %}
              <div class="ctb-feature">
                <i class="{{ block.settings.icon | default: 'fas fa-check' }}" aria-hidden="true"></i>
                <span>{{ block.settings.text }}</span>
              </div>
            {% endif %}
          {% endfor %}
        </div>
      {% endif %}
    </div>
  </div>

  <div class="ctb-section" id="about">
    <div class="ctb-container ctb-about">
      <div class="ctb-about__text">
        <h2 class="ctb-title">{{ section.settings.about_heading }}</h2>
        <p class="ctb-subtitle">{{ section.settings.about_body }}</p>
        {% if section.settings.about_bullets != blank %}
          <ul class="ctb-about__bullets">
            {% for line in section.settings.about_bullets | split: '\n' %}
              {% if line != '' %}
                <li><i class="fas fa-check" aria-hidden="true"></i><span>{{ line }}</span></li>
              {% endif %}
            {% endfor %}
          </ul>
        {% endif %}
        {% if section.settings.about_cta_text != blank %}
          <a class="ctb-btn" href="{{ section.settings.about_cta_link }}">{{ section.settings.about_cta_text }}</a>
        {% endif %}
      </div>
      {% if section.blocks | where: 'type', 'about_image' %}
        <div class="ctb-about__slider splide ctb-about-splide" aria-label="About visuals">
          <div class="splide__track">
            <ul class="splide__list">
              {% for block in section.blocks %}
                {% if block.type == 'about_image' %}
                  <li class="splide__slide">
                    {% if block.settings.image != blank %}
                      <img src="{{ block.settings.image | image_url: width: 1200 }}" alt="{{ block.settings.image.alt | default: 'About image' }}" loading="lazy">
                    {% endif %}
                  </li>
                {% endif %}
              {% endfor %}
            </ul>
          </div>
        </div>
      {% endif %}
    </div>
  </div>

  <div class="ctb-section" id="merch">
    <div class="ctb-container">
      <h2 class="ctb-title">{{ section.settings.merch_heading }}</h2>
      {% if section.settings.merch_subtitle != blank %}<p class="ctb-subtitle">{{ section.settings.merch_subtitle }}</p>{% endif %}
      {% if section.blocks | where: 'type', 'merch_item' %}
        <div class="ctb-merch-splide splide" aria-label="Merch carousel">
          <div class="splide__track">
            <ul class="splide__list">
              {% for block in section.blocks %}
                {% if block.type == 'merch_item' %}
                  <li class="splide__slide" style="width: 240px;">
                    <div class="ctb-merch__item">
                      {% if block.settings.image != blank %}
                        <img src="{{ block.settings.image | image_url: width: 800 }}" alt="{{ block.settings.image.alt | default: block.settings.title }}" loading="lazy">
                      {% endif %}
                      <div class="ctb-merch__body">
                        <h4>{{ block.settings.title }}</h4>
                        {% if block.settings.price != blank %}<p class="ctb-price">{{ block.settings.price }}</p>{% endif %}
                        {% if block.settings.link_label != blank %}
                          <a class="ctb-btn ctb-btn--ghost" href="{{ block.settings.link }}">{{ block.settings.link_label }}</a>
                        {% endif %}
                      </div>
                    </div>
                  </li>
                {% endif %}
              {% endfor %}
            </ul>
          </div>
        </div>
      {% endif %}
    </div>
  </div>

  <div class="ctb-section" id="tickets">
    <div class="ctb-container">
      <h2 class="ctb-title">{{ section.settings.tickets_heading }}</h2>
      {% if section.settings.tickets_subtitle != blank %}<p class="ctb-subtitle">{{ section.settings.tickets_subtitle }}</p>{% endif %}
      {% if section.blocks | where: 'type', 'ticket' %}
        <div class="ctb-ticket-grid">
          {% for block in section.blocks %}
            {% if block.type == 'ticket' %}
              <div class="ctb-ticket">
                {% if block.settings.image != blank %}
                  <img src="{{ block.settings.image | image_url: width: 900 }}" alt="{{ block.settings.image.alt | default: block.settings.title }}" loading="lazy">
                {% endif %}
                <div class="ctb-ticket__body">
                  <h3>{{ block.settings.title }}</h3>
                  <p class="ctb-subtitle">{{ block.settings.body }}</p>
                  {% if block.settings.button_text != blank %}
                    <a class="ctb-btn" href="{{ block.settings.button_link }}">{{ block.settings.button_text }}</a>
                  {% endif %}
                </div>
              </div>
            {% endif %}
          {% endfor %}
        </div>
      {% endif %}
    </div>
  </div>

  <div class="ctb-section" id="testimonials">
    <div class="ctb-container">
      <h2 class="ctb-title">{{ section.settings.testimonials_heading }}</h2>
      {% if section.blocks | where: 'type', 'testimonial' %}
        <div class="ctb-testimonial-splide splide" aria-label="Testimonials">
          <div class="splide__track">
            <ul class="splide__list">
              {% for block in section.blocks %}
                {% if block.type == 'testimonial' %}
                  <li class="splide__slide">
                    <div class="ctb-testimonial">
                      {% if block.settings.stars > 0 %}
                        <div class="ctb-stars">{% for i in (1..block.settings.stars) %}★{% endfor %}</div>
                      {% endif %}
                      <strong>{{ block.settings.title }}</strong>
                      <p class="ctb-subtitle">{{ block.settings.body }}</p>
                      <span>{{ block.settings.author }}</span>
                    </div>
                  </li>
                {% endif %}
              {% endfor %}
            </ul>
          </div>
        </div>
      {% endif %}
    </div>
  </div>

  <div class="ctb-section" id="gallery">
    <div class="ctb-container">
      <h2 class="ctb-title">{{ section.settings.gallery_heading }}</h2>
      {% if section.blocks | where: 'type', 'gallery_item' %}
        <div class="ctb-gallery-splide splide" aria-label="Gallery">
          <div class="splide__track">
            <ul class="splide__list">
              {% for block in section.blocks %}
                {% if block.type == 'gallery_item' %}
                  <li class="splide__slide">
                    <div class="ctb-gallery__item">
                      {% if block.settings.image != blank %}
                        <img src="{{ block.settings.image | image_url: width: 1200 }}" alt="{{ block.settings.image.alt | default: 'Gallery image' }}" loading="lazy">
                      {% endif %}
                    </div>
                  </li>
                {% endif %}
              {% endfor %}
            </ul>
          </div>
        </div>
      {% endif %}
    </div>
  </div>

  <div class="ctb-section" id="faq">
    <div class="ctb-container">
      <h2 class="ctb-title">{{ section.settings.faq_heading }}</h2>
      {% if section.blocks | where: 'type', 'faq' %}
        <div class="ctb-faq">
          {% for block in section.blocks %}
            {% if block.type == 'faq' %}
              <div class="ctb-faq__item">
                <button class="ctb-faq__question" type="button" data-ctb-faq>
                  <span>{{ block.settings.question }}</span>
                  <i class="fas fa-chevron-down" aria-hidden="true"></i>
                </button>
                <div class="ctb-faq__answer">
                  {{ block.settings.answer }}
                </div>
              </div>
            {% endif %}
          {% endfor %}
        </div>
      {% endif %}
    </div>
  </div>

  <div class="ctb-section" id="contact">
    <div class="ctb-container ctb-contact">
      <div class="ctb-contact__card">
        <h2 class="ctb-title">{{ section.settings.contact_heading }}</h2>
        <p class="ctb-subtitle">{{ section.settings.contact_intro }}</p>
        {% if section.settings.address != blank %}<p><i class="fas fa-map-marker-alt" aria-hidden="true"></i> {{ section.settings.address }}</p>{% endif %}
        {% if section.settings.instagram != blank %}<p><i class="fab fa-instagram" aria-hidden="true"></i> {{ section.settings.instagram }}</p>{% endif %}
        {% if section.settings.contact_note != blank %}<p class="ctb-note">{{ section.settings.contact_note }}</p>{% endif %}
        {% if section.settings.contact_button_text != blank %}
          <a class="ctb-btn" href="{{ section.settings.contact_button_link }}">{{ section.settings.contact_button_text }}</a>
        {% endif %}
      </div>
      <div class="ctb-contact__card">
        {% form 'contact' %}
          {% if form.posted_successfully? %}
            <div class="ctb-note">Thanks for reaching out! We'll get back to you soon.</div>
          {% elsif form.errors %}
            <div class="ctb-note">{{ form.errors | default_errors }}</div>
          {% endif %}
          <div class="ctb-contact__form">
            <p><input type="text" name="contact[name]" placeholder="Your name" required></p>
            <p><input type="email" name="contact[email]" placeholder="Email" required></p>
            <p><input type="text" name="contact[phone]" placeholder="Phone"></p>
            <p><input type="text" name="contact[subject]" placeholder="Subject"></p>
            <p><textarea name="contact[body]" placeholder="How can we help?" required></textarea></p>
            <button type="submit" class="ctb-btn">Send message</button>
          </div>
        {% endform %}
      </div>
    </div>
  </div>

  {% if section.settings.show_modal %}
    <button class="ctb-float-btn" type="button" data-ctb-open-modal>
      <i class="fas fa-ticket-alt" aria-hidden="true"></i>
      {{ section.settings.modal_button_text }}
    </button>

    <div class="ctb-modal" data-ctb-modal>
      <div class="ctb-modal__overlay" data-ctb-close-modal="true"></div>
      <div class="ctb-modal__content">
        <button class="ctb-modal__close" type="button" data-ctb-close-modal="true"><i class="fas fa-times"></i></button>
        <h2 class="ctb-title">{{ section.settings.modal_heading }}</h2>
        <p class="ctb-subtitle">{{ section.settings.modal_subtitle }}</p>
        {% if section.blocks | where: 'type', 'modal_ticket' %}
          <div class="ctb-modal__grid">
            {% for block in section.blocks %}
              {% if block.type == 'modal_ticket' %}
                <div class="ctb-ticket">
                  {% if block.settings.image != blank %}
                    <img src="{{ block.settings.image | image_url: width: 900 }}" alt="{{ block.settings.image.alt | default: block.settings.title }}" loading="lazy">
                  {% endif %}
                  <div class="ctb-ticket__body">
                    <h3>{{ block.settings.title }}</h3>
                    <p class="ctb-subtitle">{{ block.settings.body }}</p>
                    {% if block.settings.details != blank %}
                      <p class="ctb-note">{{ block.settings.details }}</p>
                    {% endif %}
                    {% if block.settings.button_text != blank %}
                      <a class="ctb-btn" href="{{ block.settings.button_link }}">{{ block.settings.button_text }}</a>
                    {% endif %}
                  </div>
                </div>
              {% endif %}
            {% endfor %}
          </div>
        {% endif %}
      </div>
    </div>
  {% endif %}
</section>

{% schema %}
{
  "name": "CTB Garage (Single Section)",
  "settings": [
    {"type": "color", "id": "background_color", "label": "Background", "default": "#000000"},
    {"type": "color", "id": "card_color", "label": "Card background", "default": "#0b0b0b"},
    {"type": "color", "id": "text_color", "label": "Text color", "default": "#f5f5f5"},
    {"type": "color", "id": "muted_color", "label": "Muted text color", "default": "#b8b8b8"},
    {"type": "color", "id": "accent_color", "label": "Accent color", "default": "#f5d76e"},
    {"type": "range", "id": "overlay_opacity", "label": "Hero overlay opacity", "min": 30, "max": 95, "step": 1, "unit": "%", "default": 80},
    {"type": "checkbox", "id": "show_info_bar", "label": "Show info bar", "default": true},
    {"type": "text", "id": "eyebrow", "label": "Hero eyebrow", "default": "Auto Body & Apparel"},
    {"type": "text", "id": "heading", "label": "Hero heading", "default": "CTB Garage"},
    {"type": "textarea", "id": "tagline", "label": "Hero tagline", "default": "Precision. Protection. Perfection—Your Ride, Our Pride."},
    {"type": "image_picker", "id": "hero_image", "label": "Fallback hero image"},
    {"type": "text", "id": "primary_text", "label": "Primary button text", "default": "Book now"},
    {"type": "url", "id": "primary_link", "label": "Primary button link", "default": "#contact"},
    {"type": "text", "id": "primary_icon", "label": "Primary icon class", "default": "fas fa-calendar-check"},
    {"type": "text", "id": "secondary_text", "label": "Secondary button text", "default": "About us"},
    {"type": "url", "id": "secondary_link", "label": "Secondary button link", "default": "#about"},
    {"type": "text", "id": "secondary_icon", "label": "Secondary icon class", "default": "fas fa-plus"},
    {"type": "text", "id": "features_heading", "label": "Features heading", "default": "Why CTB Garage"},
    {"type": "textarea", "id": "features_subtitle", "label": "Features subtitle", "default": "Professional auto body repair, apparel, and Chicago events."},
    {"type": "text", "id": "about_heading", "label": "About heading", "default": "About CTB Garage"},
    {"type": "textarea", "id": "about_body", "label": "About copy", "default": "Chicago-based auto body repair shop and automotive lifestyle brand."},
    {"type": "textarea", "id": "about_bullets", "label": "About bullets (one per line)", "default": "Collision repair and paint\nLocated at 4201 W Kinzie Street\nExclusive event tickets"},
    {"type": "text", "id": "about_cta_text", "label": "About CTA text", "default": "Contact us"},
    {"type": "url", "id": "about_cta_link", "label": "About CTA link", "default": "#contact"},
    {"type": "text", "id": "merch_heading", "label": "Merch heading", "default": "CTB Garage Merch"},
    {"type": "textarea", "id": "merch_subtitle", "label": "Merch subtitle", "default": "Exclusive apparel and accessories."},
    {"type": "text", "id": "tickets_heading", "label": "Tickets heading", "default": "Car Event Tickets"},
    {"type": "textarea", "id": "tickets_subtitle", "label": "Tickets subtitle", "default": "Grab tickets to exclusive automotive events."},
    {"type": "text", "id": "testimonials_heading", "label": "Testimonials heading", "default": "What customers are saying"},
    {"type": "text", "id": "gallery_heading", "label": "Gallery heading", "default": "Event galleries"},
    {"type": "text", "id": "faq_heading", "label": "FAQ heading", "default": "Frequently asked questions"},
    {"type": "text", "id": "contact_heading", "label": "Contact heading", "default": "Get in touch"},
    {"type": "textarea", "id": "contact_intro", "label": "Contact intro", "default": "Questions about our services, apparel, or events?"},
    {"type": "text", "id": "address", "label": "Address", "default": "4201 W Kinzie Street, Chicago, IL"},
    {"type": "text", "id": "instagram", "label": "Instagram handle", "default": "@ctbgarage"},
    {"type": "text", "id": "contact_note", "label": "Contact note", "default": "Apparel and tickets available via Instagram."},
    {"type": "text", "id": "contact_button_text", "label": "Contact button text", "default": "Follow on Instagram"},
    {"type": "url", "id": "contact_button_link", "label": "Contact button link", "default": "https://www.instagram.com/ctbgarage/"},
    {"type": "checkbox", "id": "show_modal", "label": "Show floating tickets modal", "default": true},
    {"type": "text", "id": "modal_button_text", "label": "Floating button text", "default": "Get tickets"},
    {"type": "text", "id": "modal_heading", "label": "Modal heading", "default": "Car event tickets"},
    {"type": "textarea", "id": "modal_subtitle", "label": "Modal subtitle", "default": "Premium experiences across Chicago."}
  ],
  "blocks": [
    {
      "type": "info_item",
      "name": "Info item",
      "settings": [
        {"type": "text", "id": "text", "label": "Text", "default": "4201 W Kinzie Street, Chicago, IL"},
        {"type": "url", "id": "link", "label": "Optional link"},
        {"type": "checkbox", "id": "open_in_new_tab", "label": "Open in new tab", "default": true},
        {"type": "text", "id": "icon", "label": "Icon class", "default": "fas fa-map-marker-alt"}
      ]
    },
    {
      "type": "hero_slide",
      "name": "Hero slide",
      "settings": [
        {"type": "image_picker", "id": "poster", "label": "Poster image"},
        {"type": "url", "id": "video_mp4", "label": "Video MP4 URL"},
        {"type": "image_picker", "id": "fallback_image", "label": "Fallback image"}
      ]
    },
    {
      "type": "hero_metric",
      "name": "Hero metric",
      "settings": [
        {"type": "text", "id": "value", "label": "Value", "default": "4201"},
        {"type": "text", "id": "label", "label": "Label", "default": "Kinzie St"}
      ]
    },
    {
      "type": "feature",
      "name": "Feature",
      "settings": [
        {"type": "text", "id": "text", "label": "Text", "default": "Professional auto body repair"},
        {"type": "text", "id": "icon", "label": "Icon class", "default": "fas fa-check"}
      ]
    },
    {
      "type": "about_image",
      "name": "About image",
      "settings": [
        {"type": "image_picker", "id": "image", "label": "Image"}
      ]
    },
    {
      "type": "merch_item",
      "name": "Merch item",
      "settings": [
        {"type": "image_picker", "id": "image", "label": "Image"},
        {"type": "text", "id": "title", "label": "Title", "default": "CTB Garage Hoodie"},
        {"type": "text", "id": "price", "label": "Price", "default": "$45"},
        {"type": "text", "id": "link_label", "label": "Button label", "default": "View"},
        {"type": "url", "id": "link", "label": "Button link"}
      ]
    },
    {
      "type": "ticket",
      "name": "Ticket/service",
      "settings": [
        {"type": "image_picker", "id": "image", "label": "Image"},
        {"type": "text", "id": "title", "label": "Title", "default": "Car shows & meets"},
        {"type": "textarea", "id": "body", "label": "Copy", "default": "Exclusive automotive events across Chicago."},
        {"type": "text", "id": "button_text", "label": "Button text", "default": "Get tickets"},
        {"type": "url", "id": "button_link", "label": "Button link", "default": "https://www.instagram.com/ctbgarage/"}
      ]
    },
    {
      "type": "testimonial",
      "name": "Testimonial",
      "settings": [
        {"type": "text", "id": "title", "label": "Headline", "default": "Excellent work!"},
        {"type": "textarea", "id": "body", "label": "Body", "default": "Paint match was perfect and done ahead of schedule."},
        {"type": "text", "id": "author", "label": "Author", "default": "– Mike, Chicago"},
        {"type": "range", "id": "stars", "label": "Stars", "min": 0, "max": 5, "step": 1, "default": 5}
      ]
    },
    {
      "type": "gallery_item",
      "name": "Gallery item",
      "settings": [
        {"type": "image_picker", "id": "image", "label": "Image"}
      ]
    },
    {
      "type": "faq",
      "name": "FAQ",
      "settings": [
        {"type": "text", "id": "question", "label": "Question", "default": "Where is CTB Garage located?"},
        {"type": "richtext", "id": "answer", "label": "Answer", "default": "<p>4201 W Kinzie Street, Chicago, IL</p>"}
      ]
    },
    {
      "type": "modal_ticket",
      "name": "Modal ticket",
      "settings": [
        {"type": "image_picker", "id": "image", "label": "Image"},
        {"type": "text", "id": "title", "label": "Title", "default": "VIP Experience"},
        {"type": "textarea", "id": "body", "label": "Body", "default": "Premium behind-the-scenes automotive access."},
        {"type": "text", "id": "details", "label": "Details", "default": "Starting at $75"},
        {"type": "text", "id": "button_text", "label": "Button text", "default": "Get tickets"},
        {"type": "url", "id": "button_link", "label": "Button link", "default": "https://www.instagram.com/ctbgarage/"}
      ]
    }
  ],
  "presets": [
    {
      "name": "CTB Garage full page",
      "blocks": [
        {"type": "info_item", "settings": {"text": "4201 W Kinzie Street, Chicago, IL", "icon": "fas fa-map-marker-alt"}},
        {"type": "info_item", "settings": {"text": "Professional auto body repair", "icon": "fas fa-car"}},
        {"type": "hero_slide"},
        {"type": "hero_metric", "settings": {"value": "4201", "label": "Kinzie St"}},
        {"type": "feature", "settings": {"text": "Collision repair & paint"}},
        {"type": "feature", "settings": {"text": "Chicago auto events"}},
        {"type": "about_image"},
        {"type": "merch_item", "settings": {"title": "Hoodie", "price": "$45"}},
        {"type": "ticket", "settings": {"title": "Car shows & meets"}},
        {"type": "testimonial"},
        {"type": "gallery_item"},
        {"type": "faq"},
        {"type": "modal_ticket"}
      ]
    }
  ]
}
{% endschema %}
